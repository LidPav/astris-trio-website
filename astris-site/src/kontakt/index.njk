---
layout: layout.njk
title: Kontakt
description: Booking & Kontakt
---

<h1 class="h1">Kontakt</h1>
<p class="lead">Für Konzertanfragen, Programme und Pressematerial freuen wir uns über eine Nachricht.</p>

<div class="grid">

  <!-- Karte 1: Kontakt / E-Mail -->
  <div class="card">
    <h2 class="h2">Kontakt</h2>
    <p class="small">
      E-Mail:
      <a href="mailto:{{ site.email }}">
        {{ site.email }}
      </a>
    </p>
  </div>

  <!-- Karte 2: Kontaktformular -->
  <div class="card">
    <h2 class="h2">Kontaktformular</h2>

    <form class="form" action="https://formspree.io/f/meelkjon" method="POST" data-ajax="true" accept-charset="UTF-8">

      <!-- Zeitbasierte Spam-Erkennung -->
      <input type="hidden" id="form_start_time" name="form_start_time" value="">

      <!-- Honeypot (unsichtbar) -->
      <p class="visually-hidden" aria-hidden="true">
        <label for="website">Website (leer lassen)</label>
        <input id="website" name="website" type="text" tabindex="-1" autocomplete="off" />
      </p>

      <div class="form-row">
        <label for="name">Name*</label>
        <input id="name" name="name" type="text" required autocomplete="name" placeholder="Ihr Name">
      </div>

      <div class="form-row">
        <label for="email">E-Mail*</label>
        <input id="email" name="email" type="email" required autocomplete="email" placeholder="name@example.com">
      </div>

      <div class="form-row">
        <label for="subject">Betreff</label>
        <input id="subject" name="subject" type="text" placeholder="Betreff (optional)">
      </div>

      <div class="form-row">
        <label for="message">Nachricht*</label>
        <textarea id="message" name="message" rows="6" required placeholder="Ihre Nachricht"></textarea>
      </div>

      <button type="submit" class="btn">Nachricht senden</button>

      <p id="form-status" class="small" role="status" aria-live="polite" style="margin-top:.5rem;"></p>

      <p class="form-privacy small">
        Mit dem Absenden stimmen Sie zu, dass wir Ihre Angaben zur Beantwortung Ihrer Anfrage verarbeiten.
        Details in unserer <a href="/datenschutz/">Datenschutzerklärung</a>.
      </p>

    </form>

  </div>
</div>

<script>
// Zeitstempel setzen
window.addEventListener("DOMContentLoaded", () => {
  const f = document.getElementById("form_start_time");
  if (f) f.value = Date.now();
});

// AJAX + Spam-Checks
document.addEventListener("submit", async (e) => {
  const form = e.target;
  if (!form.matches('form[data-ajax="true"]')) return;

  e.preventDefault();

  const status = document.getElementById("form-status");

  // Honeypot
  const hp = form.querySelector('input[name="website"]');
  if (hp && hp.value.trim() !== "") {
    status.style.color = "red";
    status.textContent = "Spam blockiert.";
    return;
  }

  // Zeitcheck
  const t = form.querySelector("#form_start_time");
  const diff = Date.now() - parseInt(t.value, 10);
  if (diff < 3000) {
    status.style.color = "red";
    status.textContent = "Verdächtig schnelles Absenden blockiert.";
    return;
  }

  status.style.color = "#555";
  status.textContent = "Senden …";

  try {
    const data = Object.fromEntries(new FormData(form).entries());
    const res = await fetch(form.action, {
      method: "POST",
      headers: {
        "Accept": "application/json",
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    });

    if (res.ok) {
      status.style.color = "green";
      status.textContent = "Danke! Ihre Nachricht wurde gesendet.";
      form.reset();
      t.value = Date.now();
    } else {
      status.style.color = "red";
      status.textContent = "Fehler beim Senden.";
    }
  } catch (_) {
    status.style.color = "red";
    status.textContent = "Netzwerkfehler.";
  }
});
</script>
